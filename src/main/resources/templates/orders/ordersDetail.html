<!DOCTYPE html>
<!-- Thymeleaf 템플릿 주소 -->
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/index}">
<head>
<meta charset="UTF-8">
<title>ordersDetail.html</title>
<!-- Toast UI CDN -->
<link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
<script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>
</head>
<body>
	<!-- Thymeleaf 레이아웃 div -->
	<div layout:fragment="content">
		<h2>주문 상세</h2>
		
		<!-- ToastUI 그리드 띄우는 div -->
		<div id="grid"></div>
		
		<!-- script 태그 => 타임리프 div 안에서 작성 -->
		<script>
		
		getOrdersDetail();
			
		// Toast UI grid
		// 그리드 속성, 헤더 정의 / html 요소와 연결
		const grid = new tui.Grid({
			el : document.getElementById('grid'),
			scrollX : false,
			scrollY : true,
			rowHeaders: ['checkbox'],
			columns : [ 
				{
					header : '제품코드',
					name : 'PRODUCT_CODE',
					align : "center",
				}, 
				{
					header : '제품명',
					name : 'PRODUCT_NAME',
					align : "center",
				}, 
				{
					header : '주문수량',
					name : 'ORDERS_CNT',
					align : "center",
					formatter: function(price) {
						return priceFormat(price.value);
					}
				}, 
				{
					header : '단가',
					name : 'SUPPLY_PRICE',
					align : "center",
					formatter: function(price) {
						return priceFormat(price.value);
					}
				}, 
				{
					header : '부가세',
					name : 'TAX',
					align : "center",
					formatter: function(price) {
						return priceFormat(price.value);
					}
				}, 
				{
					header : '공급가액',
					name : 'TOTAL_SUPPLY_PRICE',
					align : "center",
					formatter: function(price) {
						return priceFormat(price.value);
					}
				} 
			]
		});
			
		// 주문 조회(ajax)
		async function getOrdersDetail(ordersCode){
			await fetch("/ajax/ordersDetail" + ordersCode)
			.then(res => res.json())
			.then(res => {
				// ajax로 불러온 데이터 그리드에 넣음
				console.log(res);
				grid.resetData(res);
			})
		};
		
		// 금액 포맷 함수
		function priceFormat(price) {
			let result = price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")
			return result;
		}
			  
		</script>
	</div>
</body>
</html>